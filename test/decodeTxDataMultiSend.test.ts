import { expect, test } from "bun:test";
import decodeTxDataMultiSend from '../decodeTxDataMultiSend';

const SAMPLE_ENCODED_TXDATA = '0x00e7f252d19ab96254144fbb0d94ebc0ff7ea0c54100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000024c12542df0000000000000000000000007c388225691ee7517587254d4f4de66e2a1c0ed900e373749cd9b2d379f7f6dd595e5164498b922164000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c4abfd531000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000100000000000000000000000004c0599ae5a44757c0af6f9ec3b93da8976c150a000000000000000000000000000000000000000000000000000000000000000100000000000000000000000071041dddad3595f9ced3dccfbe3d1f4b0a16bb7000177a926569b7e976f2e68eaf4d6709312d18a705000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004a4ab646186000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000b9104d590ba8ee02b7916d09414343cdbf83e7590000000000000000000000009bd924ec6d3d49030d4e390c2ee8274fce8a9db800000000000000000000000091597ef4e3421e0ff8e2b3a391cf509a0bc213480000000000000000000000000000000000000000000000000000000000000012000000000000000000000000a2015d35fea7ee824ea0e5fb07340c5269820e2400000000000000000000000004c0599ae5a44757c0af6f9ec3b93da8976c150a0000000000000000000000004e8db0e4804bccd75e2833ca5aae9028226be2a6000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000220000000000000000000000000000000000000000000000000000000000000026000000000000000000000000000000000000000000000000000000000000002a000000000000000000000000000000000000000000000000000000000000002e00000000000000000000000000000000000000000000000000000000000000340000000000000000000000000000000000000000000000000000000000000038000000000000000000000000000000000000000000000000000000000000003c0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000057765455448000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e52616469616e7420696e7465726573742062656172696e67207765455448000000000000000000000000000000000000000000000000000000000000000000067277654554480000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002352616469616e74207661726961626c6520646562742062656172696e67207765455448000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000117661726961626c654465627477654554480000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011537461626c652044656274207765455448000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f737461626c6544656274776545544800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001100000000000000000000000000000000000000000000000000000000000000000e7f252d19ab96254144fbb0d94ebc0ff7ea0c54100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000024283d62ad000000000000000000000000fe6c435194a395c09ec95712500105943d5829e700fe6c435194a395c09ec95712500105943d5829e7000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001249dd8aad50000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000100000000000000000000000004c0599ae5a44757c0af6f9ec3b93da8976c150a0000000000000000000000000000000000000000000000000000000000001c520000000000000000000000000000000000000000000000000000000000001d4c00000000000000000000000000000000000000000000000000000000000029fe00000000000000000000000000000000000000000000000000000000000011940000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100e7f252d19ab96254144fbb0d94ebc0ff7ea0c54100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000024283d62ad000000000000000000000000bbf7edf92926b775a434f9df15860f4cd268b0a00004c0599ae5a44757c0af6f9ec3b93da8976c150a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044095ea7b300000000000000000000000030798cfe2cca822321ceed7e6085e633aabc492f000000000000000000000000000000000000000000000000016345785d8a00000030798cfe2cca822321ceed7e6085e633aabc492f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000084e8eda9df00000000000000000000000004c0599ae5a44757c0af6f9ec3b93da8976c150a000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000bbf7edf92926b775a434f9df15860f4cd268b0a0000000000000000000000000000000000000000000000000000000000000000000177a926569b7e976f2e68eaf4d6709312d18a70500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044571f03e500000000000000000000000004c0599ae5a44757c0af6f9ec3b93da8976c150a00000000000000000000000000000000000000000000000000000000000004b000177a926569b7e976f2e68eaf4d6709312d18a70500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000044d14a098300000000000000000000000004c0599ae5a44757c0af6f9ec3b93da8976c150a0000000000000000000000000000000000000000000000000000000000000258';

const EXPECTED_OUTPUT = [
  {
    address: "0xe7f252d19ab96254144fbb0d94ebc0ff7ea0c541",
    value: 0n,
    data: "0xc12542df0000000000000000000000007c388225691ee7517587254d4f4de66e2a1c0ed9",
  },
  {
    address: "0xe373749cd9b2d379f7f6dd595e5164498b922164",
    value: 0n,
    data: "0xabfd531000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000100000000000000000000000004c0599ae5a44757c0af6f9ec3b93da8976c150a000000000000000000000000000000000000000000000000000000000000000100000000000000000000000071041dddad3595f9ced3dccfbe3d1f4b0a16bb70",
  },
  {
    address: "0x177a926569b7e976f2e68eaf4d6709312d18a705",
    value: 0n,
    data: "0xab646186000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000b9104d590ba8ee02b7916d09414343cdbf83e7590000000000000000000000009bd924ec6d3d49030d4e390c2ee8274fce8a9db800000000000000000000000091597ef4e3421e0ff8e2b3a391cf509a0bc213480000000000000000000000000000000000000000000000000000000000000012000000000000000000000000a2015d35fea7ee824ea0e5fb07340c5269820e2400000000000000000000000004c0599ae5a44757c0af6f9ec3b93da8976c150a0000000000000000000000004e8db0e4804bccd75e2833ca5aae9028226be2a6000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000220000000000000000000000000000000000000000000000000000000000000026000000000000000000000000000000000000000000000000000000000000002a000000000000000000000000000000000000000000000000000000000000002e00000000000000000000000000000000000000000000000000000000000000340000000000000000000000000000000000000000000000000000000000000038000000000000000000000000000000000000000000000000000000000000003c0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000057765455448000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e52616469616e7420696e7465726573742062656172696e67207765455448000000000000000000000000000000000000000000000000000000000000000000067277654554480000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002352616469616e74207661726961626c6520646562742062656172696e67207765455448000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000117661726961626c654465627477654554480000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011537461626c652044656274207765455448000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f737461626c65446562747765455448000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011000000000000000000000000000000000000000000000000000000000000000",
  },
  {
    address: "0xe7f252d19ab96254144fbb0d94ebc0ff7ea0c541",
    value: 0n,
    data: "0x283d62ad000000000000000000000000fe6c435194a395c09ec95712500105943d5829e7",
  },
  {
    address: "0xfe6c435194a395c09ec95712500105943d5829e7",
    value: 0n,
    data: "0x9dd8aad50000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000100000000000000000000000004c0599ae5a44757c0af6f9ec3b93da8976c150a0000000000000000000000000000000000000000000000000000000000001c520000000000000000000000000000000000000000000000000000000000001d4c00000000000000000000000000000000000000000000000000000000000029fe000000000000000000000000000000000000000000000000000000000000119400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001",
  },
  {
    address: "0xe7f252d19ab96254144fbb0d94ebc0ff7ea0c541",
    value: 0n,
    data: "0x283d62ad000000000000000000000000bbf7edf92926b775a434f9df15860f4cd268b0a0",
  },
  {
    address: "0x04c0599ae5a44757c0af6f9ec3b93da8976c150a",
    value: 0n,
    data: "0x095ea7b300000000000000000000000030798cfe2cca822321ceed7e6085e633aabc492f000000000000000000000000000000000000000000000000016345785d8a0000",
  },
  {
    address: "0x30798cfe2cca822321ceed7e6085e633aabc492f",
    value: 0n,
    data: "0xe8eda9df00000000000000000000000004c0599ae5a44757c0af6f9ec3b93da8976c150a000000000000000000000000000000000000000000000000016345785d8a0000000000000000000000000000bbf7edf92926b775a434f9df15860f4cd268b0a00000000000000000000000000000000000000000000000000000000000000000",
  },
  {
    address: "0x177a926569b7e976f2e68eaf4d6709312d18a705",
    value: 0n,
    data: "0x571f03e500000000000000000000000004c0599ae5a44757c0af6f9ec3b93da8976c150a00000000000000000000000000000000000000000000000000000000000004b0",
  },
  {
    address: "0x177a926569b7e976f2e68eaf4d6709312d18a705",
    value: 0n,
    data: "0xd14a098300000000000000000000000004c0599ae5a44757c0af6f9ec3b93da8976c150a0000000000000000000000000000000000000000000000000000000000000258",
  }
]

test('Should decode the "multiSend" transaction data correctly', () => {
  const result = decodeTxDataMultiSend(SAMPLE_ENCODED_TXDATA);
  expect(result).toEqual(EXPECTED_OUTPUT);
});